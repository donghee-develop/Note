# 파일 업로드

## 흐름
1. @RequestParam 을 통해 MultipartFile로 파일 받기 (프론트 formData)
2. 서비스에서 파일 검증 메소드로 검증 후 저장 메소드 호출
3. 다중 파일 일 시 단일 파일 업로드 호출

### properties 사용에 대한 문제점
- 프로퍼티에서 파일 Valid (경로, 사이즈, 확장자) 등 정의 시 도메인이 여러 개 일 때 옵션이 다를 수 있다. ex) 회원 이미지 5mb 제한, 경로 user/userId/, 게시판 이미지, gif 경로 board/userId
- 위와 같은 경우에는 각 도메인에 맞게 클래스 생성 후 Valid 지정, 그리고 인터페이스를 통해 구현토록 하여 새로운 도메인이 생길 경우 단순히 인터페이스만 impl 받음으로써 쉽게 구현할 수 있다.


### 추가할 수 있는 사항
- 파일 해쉬 검사를 통한 중복 파일 검사
  - 스토리지에 해당 파일이 존재할 경우에 참조하게 한다. 만약 참조했는데 원본을 삭제한다면?? 그 문제를 해결하기 위해서는 ref 컬럼을 추가하여 그 값이 0이 되는 순간 삭제하도록 한다.
- 보안
  - 파일 시그니처 검사(확장자의 고유 패턴) + Path Traversal 방어 (../etc/passwd와 같은 경로에 접근하지 못하도록 해야함, 기행문자에 대해선 replace)
- 스프링
  - 스프링으로 파일을 받을 경우 MultipartResolver 빈 등록